# å¢é‡ç¿»è¯‘å·¥å…·ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

`translate.py` æ˜¯ä¸€ä¸ªä¼˜åŒ–çš„å¢é‡ç¿»è¯‘å·¥å…·ï¼Œä¸“ä¸º B4B-Assistant é¡¹ç›®è®¾è®¡ã€‚å®ƒèƒ½å¤Ÿæ™ºèƒ½æ£€æµ‹æ–‡ä»¶å˜åŒ–ï¼Œåªåœ¨éœ€è¦æ—¶æ›´æ–°ç¿»è¯‘æ–‡ä»¶ï¼Œå¤§å¤§æé«˜äº†å¼€å‘æ•ˆç‡ã€‚

## ä¸»è¦ç‰¹æ€§

âœ… **å¢é‡æ›´æ–°**: åªæœ‰åœ¨æºæ–‡ä»¶å‘ç”Ÿå˜åŒ–æ—¶æ‰æ›´æ–°ç¿»è¯‘  
âœ… **æ™ºèƒ½æ£€æµ‹**: åŸºäºæ–‡ä»¶å“ˆå¸Œå’Œä¿®æ”¹æ—¶é—´çš„å˜åŒ–æ£€æµ‹  
âœ… **ç¼“å­˜æœºåˆ¶**: è®°å½•æ–‡ä»¶çŠ¶æ€ï¼Œé¿å…é‡å¤å¤„ç†  
âœ… **è‡ªåŠ¨å·¥å…·å‘ç°**: è‡ªåŠ¨æŸ¥æ‰¾ pyside6-lupdate å’Œ pyside6-lrelease å·¥å…·  
âœ… **ä¸€ä½“åŒ–ç¼–è¯‘**: é›†æˆç¿»è¯‘æ–‡ä»¶ç¼–è¯‘åŠŸèƒ½ï¼Œä¸€æ­¥åˆ°ä½  
âœ… **è¯¦ç»†æ—¥å¿—**: æä¾›æ¸…æ™°çš„å¤„ç†çŠ¶æ€å’Œè¿›åº¦ä¿¡æ¯  

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬å‘½ä»¤

```bash
# æ‰§è¡Œå¢é‡ç¿»è¯‘æ›´æ–°
python translate.py

# ä¸æ‰“å¼€ Qt Linguist
python translate.py --no-linguist

# å¼ºåˆ¶æ›´æ–°æ‰€æœ‰ç¿»è¯‘ï¼ˆå¿½ç•¥ç¼“å­˜ï¼‰
python translate.py --force

# åªç¼–è¯‘ç¿»è¯‘æ–‡ä»¶ï¼ˆ.ts -> .qmï¼‰
python translate.py --compile

# æ›´æ–°å¹¶ç¼–è¯‘ç¿»è¯‘æ–‡ä»¶ï¼ˆä¸€æ­¥åˆ°ä½ï¼‰
python translate.py --update-and-compile

# æŸ¥çœ‹ç¿»è¯‘çŠ¶æ€
python translate.py --status

# æ¸…ç†ç¼“å­˜
python translate.py --clean

# æ‰‹åŠ¨æŒ‡å®šå·¥å…·è·¯å¾„
python translate.py --lupdate-path "C:\Python311\Scripts\pyside6-lupdate.exe"
python translate.py --lrelease-path "C:\Python311\Scripts\pyside6-lrelease.exe"
```

### å‘½ä»¤è¡Œå‚æ•°

| å‚æ•° | ç®€å†™ | è¯´æ˜ |
|------|------|------|
| `--force` | `-f` | å¼ºåˆ¶æ›´æ–°æ‰€æœ‰ç¿»è¯‘ï¼Œå¿½ç•¥ç¼“å­˜ |
| `--no-linguist` | | ä¸è‡ªåŠ¨æ‰“å¼€ Qt Linguist |
| `--status` | `-s` | æ˜¾ç¤ºå½“å‰ç¿»è¯‘çŠ¶æ€ |
| `--clean` | `-c` | æ¸…ç†ç¼“å­˜æ–‡ä»¶ |
| `--compile` | | åªç¼–è¯‘ç¿»è¯‘æ–‡ä»¶ï¼ˆ.ts -> .qmï¼‰ |
| `--update-and-compile` | | æ›´æ–°å¹¶ç¼–è¯‘ç¿»è¯‘æ–‡ä»¶ï¼ˆä¸€æ­¥åˆ°ä½ï¼‰ |
| `--lupdate-path` | | æ‰‹åŠ¨æŒ‡å®š lupdate å·¥å…·è·¯å¾„ |
| `--lrelease-path` | | æ‰‹åŠ¨æŒ‡å®š lrelease å·¥å…·è·¯å¾„ |

## å·¥ä½œåŸç†

### 1. æ–‡ä»¶ç›‘æ§
- æ‰«æ `app/view/ui/` å’Œ `app/view/` ç›®å½•ä¸‹çš„æ‰€æœ‰ Python æ–‡ä»¶
- è®¡ç®—æ¯ä¸ªæ–‡ä»¶çš„ MD5 å“ˆå¸Œå€¼å’Œä¿®æ”¹æ—¶é—´
- ä¸ç¼“å­˜ä¸­çš„è®°å½•è¿›è¡Œæ¯”è¾ƒ

### 2. å˜åŒ–æ£€æµ‹
- **æ–‡ä»¶ä¿®æ”¹**: å“ˆå¸Œå€¼æˆ–ä¿®æ”¹æ—¶é—´å‘ç”Ÿå˜åŒ–
- **æ–‡ä»¶åˆ é™¤**: æ–‡ä»¶ä¸å†å­˜åœ¨
- **æ–°å¢æ–‡ä»¶**: ç¼“å­˜ä¸­æ²¡æœ‰è®°å½•çš„æ–‡ä»¶

### 3. å¢é‡æ›´æ–°
- åªæœ‰æ£€æµ‹åˆ°å˜åŒ–æ—¶æ‰æ‰§è¡Œ `pyside6-lupdate`
- ä¿ç•™ç°æœ‰ç¿»è¯‘ï¼Œåªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†
- æ›´æ–°ç¼“å­˜è®°å½•ï¼Œè®°å½•æœ¬æ¬¡å¤„ç†çŠ¶æ€

### 4. å·¥å…·è‡ªåŠ¨å‘ç°
è„šæœ¬ä¼šè‡ªåŠ¨åœ¨ä»¥ä¸‹ä½ç½®æŸ¥æ‰¾ `pyside6-lupdate` å’Œ `pyside6-lrelease` å·¥å…·ï¼š
- ç³»ç»Ÿ PATH ç¯å¢ƒå˜é‡
- Python å®‰è£…ç›®å½•çš„ Scripts æ–‡ä»¶å¤¹
- è™šæ‹Ÿç¯å¢ƒçš„ Scripts æ–‡ä»¶å¤¹
- å¸¸è§çš„ Python å®‰è£…è·¯å¾„

### 5. ç¿»è¯‘ç¼–è¯‘
- è‡ªåŠ¨å°† `.ts` æ–‡ä»¶ç¼–è¯‘ä¸º `.qm` æ–‡ä»¶
- æ”¯æŒå•ç‹¬ç¼–è¯‘æˆ–ä¸æ›´æ–°ä¸€èµ·æ‰§è¡Œ
- æä¾›ç¼–è¯‘çŠ¶æ€å’Œæ–‡ä»¶å¤§å°ä¿¡æ¯

## ç¼“å­˜æ–‡ä»¶

ç¼“å­˜ä¿¡æ¯å­˜å‚¨åœ¨ `.translation_cache.json` æ–‡ä»¶ä¸­ï¼ŒåŒ…å«ï¼š

```json
{
  "files": {
    "app/view/ui/cards_ui.py": {
      "hash": "abc123...",
      "mtime": 1629876543.21,
      "size": 12345
    }
  },
  "last_update": 1629876543.21,
  "version": "1.0"
}
```

## å¼€å‘å·¥ä½œæµ

### æ—¥å¸¸å¼€å‘
```bash
# ä¿®æ”¹ UI æ–‡ä»¶åï¼Œæ›´æ–°å¹¶ç¼–è¯‘ç¿»è¯‘ï¼ˆæ¨èï¼‰
python translate.py --update-and-compile --no-linguist

# æˆ–è€…åˆ†æ­¥æ‰§è¡Œ
python translate.py --no-linguist  # æ›´æ–°ç¿»è¯‘
python translate.py --compile      # ç¼–è¯‘ç¿»è¯‘

# æ£€æŸ¥æ˜¯å¦æœ‰éœ€è¦ç¿»è¯‘çš„æ–°å­—ç¬¦ä¸²
python translate.py --status
```

### å¤§è§„æ¨¡é‡æ„å
```bash
# å¼ºåˆ¶å®Œæ•´æ›´æ–°å¹¶ç¼–è¯‘
python translate.py --update-and-compile --force

# æ¸…ç†ç¼“å­˜ï¼Œé‡æ–°å¼€å§‹
python translate.py --clean
python translate.py --update-and-compile
```

### ç¿»è¯‘å·¥ä½œ
```bash
# æ›´æ–°ç¿»è¯‘æ–‡ä»¶å¹¶æ‰“å¼€ Qt Linguist è¿›è¡Œç¿»è¯‘
python translate.py

# ç¿»è¯‘å®Œæˆåç¼–è¯‘
python translate.py --compile
```

### å‘å¸ƒå‰æ£€æŸ¥
```bash
# ç¡®ä¿ç¿»è¯‘æ–‡ä»¶æ˜¯æœ€æ–°çš„
python translate.py --update-and-compile --force
```

## æ€§èƒ½ä¼˜åŒ–

### è·³è¿‡ä¸å¿…è¦çš„æ›´æ–°
- å¦‚æœæ²¡æœ‰æ–‡ä»¶å˜åŒ–ï¼Œè„šæœ¬ä¼šç«‹å³é€€å‡º
- æ˜¾ç¤ºä¸Šæ¬¡æ›´æ–°æ—¶é—´ï¼Œä¾¿äºè·Ÿè¸ª

### æ‰¹é‡å¤„ç†
- ä¸€æ¬¡æ€§å¤„ç†æ‰€æœ‰å˜åŒ–çš„æ–‡ä»¶
- é¿å…é‡å¤å¯åŠ¨ lupdate å·¥å…·

### æ™ºèƒ½ç¼“å­˜
- åŸºäºæ–‡ä»¶å†…å®¹å“ˆå¸Œï¼Œè€Œä¸ä»…ä»…æ˜¯ä¿®æ”¹æ—¶é—´
- å‡†ç¡®æ£€æµ‹çœŸæ­£çš„å˜åŒ–

## æ•…éšœæ’é™¤

### æ‰¾ä¸åˆ°å·¥å…·
```bash
# æ£€æŸ¥ PySide6 æ˜¯å¦æ­£ç¡®å®‰è£…
pip install PySide6

# æ‰‹åŠ¨æŒ‡å®šå·¥å…·è·¯å¾„
python translate.py --lupdate-path "å®Œæ•´è·¯å¾„\pyside6-lupdate.exe"
python translate.py --lrelease-path "å®Œæ•´è·¯å¾„\pyside6-lrelease.exe"

# æˆ–è€…åŒæ—¶æŒ‡å®šä¸¤ä¸ªå·¥å…·
python translate.py --update-and-compile \
  --lupdate-path "è·¯å¾„\pyside6-lupdate.exe" \
  --lrelease-path "è·¯å¾„\pyside6-lrelease.exe"
```

### ç¼–è¯‘å¤±è´¥
```bash
# æ£€æŸ¥æºæ–‡ä»¶æ˜¯å¦å­˜åœ¨
python translate.py --status

# å°è¯•å•ç‹¬ç¼–è¯‘
python translate.py --compile

# å¦‚æœæ‰¾ä¸åˆ° lreleaseï¼Œä½¿ç”¨ Python éªŒè¯
python -c "from PySide6.QtCore import QTranslator; print('PySide6 available')"
```

### ç¼“å­˜é—®é¢˜
```bash
# æ¸…ç†ç¼“å­˜é‡æ–°å¼€å§‹
python translate.py --clean

# å¼ºåˆ¶æ›´æ–°
python translate.py --force
```

### ç¿»è¯‘æ–‡ä»¶æŸå
```bash
# å¤‡ä»½ç°æœ‰ç¿»è¯‘æ–‡ä»¶
copy app\resource\i18n\app.zh_CN.ts app\resource\i18n\app.zh_CN.ts.backup

# å¼ºåˆ¶é‡æ–°ç”Ÿæˆ
python translate.py --force
```

## è¾“å‡ºç¤ºä¾‹

### æ›´æ–°å’Œç¼–è¯‘ä¸€ä½“åŒ–
```
==================================================
å¢é‡ç¿»è¯‘æ›´æ–°æ£€æŸ¥
==================================================
æ£€æµ‹åˆ°å˜æ›´çš„æ–‡ä»¶:
  - app\view\ui\cards_ui.py
ğŸ“ æ£€æµ‹åˆ°å˜åŒ–: å˜æ›´æ–‡ä»¶: 1, åˆ é™¤æ–‡ä»¶: 0
 æ‰¾åˆ° lupdate å·¥å…·: ...\pyside6-lupdate
ğŸ”„ æ­£åœ¨æ›´æ–°ç¿»è¯‘æ–‡ä»¶...
âœ… ç¿»è¯‘æ–‡ä»¶å·²æˆåŠŸæ›´æ–°: ...\app.zh_CN.ts

==================================================
ç¼–è¯‘ç¿»è¯‘æ–‡ä»¶
==================================================
ğŸ” æ‰¾åˆ° lrelease å·¥å…·: ...\pyside6-lrelease
ğŸ”„ æ‰§è¡Œå‘½ä»¤: ...\pyside6-lrelease ...
âœ… æˆåŠŸç¼–è¯‘ç¿»è¯‘æ–‡ä»¶: ...\app.zh_CN.qm
ğŸ“Š ç¼–è¯‘åæ–‡ä»¶å¤§å°: 7627 å­—èŠ‚

ğŸ‰ ç¿»è¯‘æ›´æ–°å’Œç¼–è¯‘å®Œæˆï¼
```

### åªç¼–è¯‘ç¿»è¯‘
```
==================================================
ç¼–è¯‘ç¿»è¯‘æ–‡ä»¶
==================================================
ğŸ“„ æºæ–‡ä»¶: ...\app.zh_CN.ts
ğŸ“„ ç›®æ ‡æ–‡ä»¶: ...\app.zh_CN.qm
ğŸ” æ‰¾åˆ° lrelease å·¥å…·: ...\pyside6-lrelease
âœ… æˆåŠŸç¼–è¯‘ç¿»è¯‘æ–‡ä»¶: ...\app.zh_CN.qm
ğŸ“Š ç¼–è¯‘åæ–‡ä»¶å¤§å°: 7908 å­—èŠ‚

ğŸ‰ ç¿»è¯‘ç¼–è¯‘å®Œæˆï¼
```

### æ— å˜åŒ–è·³è¿‡
```
==================================================
å¢é‡ç¿»è¯‘æ›´æ–°æ£€æŸ¥
==================================================
âœ… æ²¡æœ‰æ£€æµ‹åˆ°æ–‡ä»¶å˜åŒ–ï¼Œæ— éœ€æ›´æ–°ç¿»è¯‘
ä¸Šæ¬¡æ›´æ–°æ—¶é—´: 2025-08-21 20:48:56

ğŸ‰ ç¿»è¯‘æ›´æ–°å®Œæˆï¼
```

## ä¸æ—§ç‰ˆæœ¬çš„åŒºåˆ«

ä¹‹å‰çš„å·¥ä½œæµéœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š
```bash
# æ—§æ–¹å¼ï¼ˆéœ€è¦ä¸¤ä¸ªè„šæœ¬ï¼‰
python translate.py          # æ›´æ–°ç¿»è¯‘
python compile_translation.py  # ç¼–è¯‘ç¿»è¯‘
```

ç°åœ¨åªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼š
```bash
# æ–°æ–¹å¼ï¼ˆä¸€ä½“åŒ–ï¼‰
python translate.py --update-and-compile
```

`compile_translation.py` çš„åŠŸèƒ½å·²ç»å®Œå…¨æ•´åˆåˆ° `translate.py` ä¸­ï¼Œå¯ä»¥åˆ é™¤æ—§çš„ç¼–è¯‘è„šæœ¬ã€‚

## æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½ç¿»è¯‘**: åœ¨å¤§è§„æ¨¡æ›´æ–°å‰å¤‡ä»½ `.ts` æ–‡ä»¶
2. **è™šæ‹Ÿç¯å¢ƒ**: ç¡®ä¿åœ¨æ­£ç¡®çš„ Python ç¯å¢ƒä¸­è¿è¡Œ
3. **æ–‡ä»¶ç¼–ç **: æ‰€æœ‰æºæ–‡ä»¶åº”ä½¿ç”¨ UTF-8 ç¼–ç 
4. **è·¯å¾„é—®é¢˜**: ä½¿ç”¨ç»å¯¹è·¯å¾„é¿å…å·¥ä½œç›®å½•é—®é¢˜

## æ›´æ–°å†å²

- **v1.0**: åˆå§‹å¢é‡ç¿»è¯‘å®ç°
- **v1.1**: æ·»åŠ è‡ªåŠ¨å·¥å…·å‘ç°åŠŸèƒ½
- **v1.2**: æ”¹è¿›ç¼“å­˜æœºåˆ¶å’Œé”™è¯¯å¤„ç†
